> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-08 | **–í–µ—Ä—Å–∏—è NiFi:** 1.x.x

–£—á–µ–±–Ω—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å Apache NiFi –∏ Kafka: NiFi + NiFi Registry + Postgres + Kafka + Kafka UI.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](#—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
  - [–ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏](#—á—Ç–æ-—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è-–º–µ–∂–¥—É-–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏)
- [–ê–¥—Ä–µ—Å–∞ –∏ –¥–æ—Å—Ç—É–ø—ã](#–∞–¥—Ä–µ—Å–∞-–∏-–¥–æ—Å—Ç—É–ø—ã)
- [–í–∞–∂–Ω–æ –ø—Ä–æ –∞–¥—Ä–µ—Å–∞ (–≤–Ω—É—Ç—Ä–∏ Docker –∏ —Å —Ö–æ—Å—Ç–∞)](#–≤–∞–∂–Ω–æ-–ø—Ä–æ-–∞–¥—Ä–µ—Å–∞-–≤–Ω—É—Ç—Ä–∏-docker-–∏-—Å-—Ö–æ—Å—Ç–∞)
- [PostgreSQL](#postgresql)
  - [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ DBeaver (—É–¥–æ–±–Ω–µ–µ –≤—Å–µ–≥–æ)](#–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ-—á–µ—Ä–µ–∑-dbeaver-—É–¥–æ–±–Ω–µ–µ-–≤—Å–µ–≥–æ)
  - [–ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)](#—á–µ—Ä–µ–∑-–∫–æ–Ω—Å–æ–ª—å-–µ—Å–ª–∏-–Ω—É–∂–Ω–æ)
- [Kafka](#kafka)
  - [–†–∞–±–æ—Ç–∞ —Å Kafka](#—Ä–∞–±–æ—Ç–∞-—Å-kafka)
    - [–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã CLI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)](#–±–∞–∑–æ–≤—ã–µ-–∫–æ–º–∞–Ω–¥—ã-cli-–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [–ü—Ä–∏–º–µ—Ä—ã flow (—à–∞–±–ª–æ–Ω—ã)](#–ø—Ä–∏–º–µ—Ä—ã-flow-—à–∞–±–ª–æ–Ω—ã)
  - [–ü–∞–º—è—Ç–∫–∞: –∫–∞–∫ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å Process Group / Flow –≤ NiFi](#–ø–∞–º—è—Ç–∫–∞-–∫–∞–∫-–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å-process-group--flow-–≤-nifi)
- [Shared folder (–æ–±—â–∞—è –ø–∞–ø–∫–∞)](#shared-folder-–æ–±—â–∞—è-–ø–∞–ø–∫–∞)
- [–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã](#–ø–æ–ª–µ–∑–Ω—ã–µ-–∫–æ–º–∞–Ω–¥—ã)
- [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏](#–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
  - [Checklist](#checklist)
  - [–ü—Ä–æ–≤–µ—Ä–∫–∞ flow](#–ø—Ä–æ–≤–µ—Ä–∫–∞-flow)
- [–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç](#–µ—Å–ª–∏-—á—Ç–æ-—Ç–æ-–Ω–µ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
  - [–ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∑–∞–ø—É—Å–∫–æ–º-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤)
  - [–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –≤ NiFi](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º-–≤-nifi)
  - [–ü—Ä–æ–±–ª–µ–º—ã —Å Kafka](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-kafka)
  - [–ü—Ä–æ–±–ª–µ–º—ã —Å Postgres](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-postgres)
  - [–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø—Ä–∞–≤–∞–º–∏-–¥–æ—Å—Ç—É–ø–∞)
  - [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```sh
docker compose up -d
docker compose ps
```

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–µ–Ω–¥:
```sh
docker compose stop
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ (–ø–æ—Å–ª–µ `stop` —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è):
```sh
docker compose start
```

–£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ —Å–µ—Ç—å:
```sh
docker compose down
```
–ó–∞—Ç–µ–º –ø–æ–¥–Ω—è—Ç—å –æ–±—Ä–∞—Ç–Ω–æ (—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –≤ —Ç–æ–º–∞—Ö):
```sh
docker compose up -d
```

–£–¥–∞–ª–∏—Ç—å –µ—â—ë –∏ —Ç–æ–º–∞ (volumes) ‚Äî –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å (–¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ):
```sh
docker compose down -v
```

### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
- `docker compose stop/start` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤—Å—ë (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è).
- `docker compose down` ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —É–¥–∞–ª—è—é—Ç—Å—è, –Ω–æ —Ç–æ–º–∞ (volumes) –æ—Å—Ç–∞—é—Ç—Å—è: —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è NiFi (`conf`/`state`), NiFi Registry, Postgres.
- `docker compose down -v` ‚Äî –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å: —É–¥–∞–ª—è—é—Ç—Å—è –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∏ —Ç–æ–º–∞ (volumes).

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≤ —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Kafka-—Å–æ–æ–±—â–µ–Ω–∏—è/—Ç–æ–ø–∏–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É `docker compose down` ‚Üí `up` (—á—Ç–æ–±—ã –Ω–µ –∫–æ–ø–∏—Ç—å –¥–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ). –ú–µ–∂–¥—É `stop` ‚Üí `start` Kafka —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ç–æ–º–∞ (volume) –¥–ª—è Kafka –µ—Å—Ç—å –≤ `docker-compose.yml`.

## –ê–¥—Ä–µ—Å–∞ –∏ –¥–æ—Å—Ç—É–ø—ã
- NiFi: http://localhost:18443/nifi/
  > üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è. –õ–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è.
- NiFi docs: https://nifi.apache.org/documentation/
- Registry: http://localhost:18080/nifi-registry
- Registry docs: https://nifi.apache.org/docs/nifi-registry-docs/
- Kafka UI: http://localhost:8082/
- Kafka UI docs: https://docs.kafka-ui.provectus.io/

## –í–∞–∂–Ω–æ –ø—Ä–æ –∞–¥—Ä–µ—Å–∞ (–≤–Ω—É—Ç—Ä–∏ Docker –∏ —Å —Ö–æ—Å—Ç–∞)

> ‚ö†Ô∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:** –ï—Å–ª–∏ –≤—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ *–≤ NiFi*, —Ç–æ `localhost` –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º (NiFi –∂–∏–≤—ë—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ).

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–∑ `docker-compose.yml`:
- Postgres (–∏–∑ NiFi): `jdbc:postgresql://postgres:5432/app`
- Kafka (–∏–∑ NiFi): `kafka:29092`
- Registry (–∏–∑ NiFi): `http://registry:18080`

–ê —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:
- Postgres: `jdbc:postgresql://localhost:5437/app`
- Kafka: `localhost:9092`

## PostgreSQL
JDBC-–¥—Ä–∞–π–≤–µ—Ä –¥–ª—è Postgres –ª–µ–∂–∏—Ç –≤ `drivers/` –∏ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä NiFi –∫–∞–∫ `/opt/nifi/nifi-current/drivers/`.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è DBCP –≤ NiFi:
- Database Connection URL: `jdbc:postgresql://postgres:5432/app`
- Database Driver Class Name: `org.postgresql.Driver`
- Database Driver Location(s): `/opt/nifi/nifi-current/drivers/postgresql-42.7.4.jar`
- Database User: `postgres`
- Password: `postgres`

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ DBeaver (—É–¥–æ–±–Ω–µ–µ –≤—Å–µ–≥–æ)
Postgres –ø—Ä–æ–±—Ä–æ—à–µ–Ω –Ω–∞—Ä—É–∂—É –Ω–∞ –ø–æ—Ä—Ç `5437`, –ø–æ—ç—Ç–æ–º—É –≤ DBeaver —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
- Host: `localhost`
- Port: `5437`
- Database: `app`
- Username: `postgres`
- Password: `postgres`

–ï—Å–ª–∏ DBeaver –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —Å–∫–∞—á–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä ‚Äî —Å–æ–≥–ª–∞—à–∞–π—Ç–µ—Å—å —Å–∫–∞—á–∞—Ç—å/—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä PostgreSQL.

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-—Å—Ö–µ–º/—Ç–∞–±–ª–∏—Ü:
```sh
docker compose exec -T postgres psql -U postgres -d app -f /nifi-templates/SampleKafka2Postgres.sql
```
–ó–∞–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –∏–ª–∏ –ø–æ—Å–ª–µ `docker compose down -v` (—Å–∫—Ä–∏–ø—Ç –Ω–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π: –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –±—É–¥—É—Ç –æ—à–∏–±–∫–∏ –ø—Ä–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ö–µ–º—ã/—Ç–∞–±–ª–∏—Ü—ã).

### –ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö:
```sh
docker compose exec -it postgres bash -c "export PGPASSWORD=postgres; psql -U postgres -d app"
select * from ods.samplekafka2postgres order by id desc limit 10;
```

## Kafka
- –° –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç): `localhost:9092`
- –ò–∑ NiFi (–≤–Ω—É—Ç—Ä–∏ Docker): `kafka:29092`

### –†–∞–±–æ—Ç–∞ —Å Kafka

> üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Kafka UI** (http://localhost:8082/) ‚Äî —ç—Ç–æ —É–¥–æ–±–Ω—ã–π –∏ –Ω–∞–≥–ª—è–¥–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–ø–∏–∫–æ–≤, —Å–æ–æ–±—â–µ–Ω–∏–π –∏ consumer groups.

**Kafka CLI** (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞) –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è:
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤
- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–æ–ø–∏–∫–æ–≤)
- –ë—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑ –±—Ä–∞—É–∑–µ—Ä–∞

#### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã CLI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `docker compose exec kafka`:

**–ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π:**
```sh
docker compose exec kafka kafka-console-consumer.sh \
  --bootstrap-server localhost:9092 \
  --topic Sample2Kafka \
  --from-beginning
```

**–ó–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π:**
```sh
docker compose exec kafka kafka-console-producer.sh \
  --bootstrap-server localhost:9092 \
  --topic Sample2Kafka
```
–ü—Ä–∏–º–µ—Ä JSON-—Å–æ–æ–±—â–µ–Ω–∏—è: `{"dttm": 1704698992000, "txt": "–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"}`

**–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Ç–æ–ø–∏–∫–æ–≤:**
```sh
docker compose exec kafka kafka-topics.sh --bootstrap-server localhost:9092 --list
```

## –ü—Ä–∏–º–µ—Ä—ã flow (—à–∞–±–ª–æ–Ω—ã)
–ö–æ—Ä–æ—Ç–∫–∏–π –≥–∞–π–¥ –¥–ª—è –º–µ–Ω—Ç–∏ –ø–æ JSON-–≤–µ—Ä—Å–∏–∏ –ø–æ—Ç–æ–∫–æ–≤: `MENTEE_GUIDE_JSON_FLOWS.md`.

–í `nifi-templates/` –ª–µ–∂–∞—Ç –ø—Ä–∏–º–µ—Ä—ã:
- `Sample2Kafka.json` ‚Äî –ø—É–±–ª–∏–∫—É–µ—Ç JSON-—Å–æ–æ–±—â–µ–Ω–∏—è –≤ Kafka topic `Sample2Kafka`
- `SampleKafka2Postgres.json` ‚Äî —á–∏—Ç–∞–µ—Ç JSON –∏–∑ Kafka topic `Sample2Kafka` –∏ –ø–∏—à–µ—Ç –≤ Postgres (–≤ `stg.samplekafka2postgres`, –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç `ods.load_samplekafka2postgres()`)
- `Sample2Kafka-avro.json` / `SampleKafka2Postgres-avro.json` ‚Äî Avro-–≤–µ—Ä—Å–∏–∏ –ø–æ—Ç–æ–∫–æ–≤

### –ü–∞–º—è—Ç–∫–∞: –∫–∞–∫ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å Process Group / Flow –≤ NiFi
–§–∞–π–ª—ã –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä —Å –≤–∞—à–µ–π –º–∞—à–∏–Ω—ã (–∫–∞—Ç–∞–ª–æ–≥ `nifi-templates/`).

–ù–∞–∑–≤–∞–Ω–∏–µ –ø—É–Ω–∫—Ç–∞ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç UI/–≤–µ—Ä—Å–∏–∏, –Ω–æ —Å–º—ã—Å–ª –æ–¥–∏–Ω ‚Äî ‚Äú–∑–∞–≥—Ä—É–∑–∏—Ç—å process group/flow definition –∏–∑ —Ñ–∞–π–ª–∞‚Äù:
1) –í –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤—Ä–æ–¥–µ `Upload` / `Import` / `Process Group` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ —Ñ–∞–π–ª–∞.
2) –í—ã–±–µ—Ä–∏—Ç–µ `nifi-templates/SampleKafka2Postgres.json` (–∏–ª–∏ `Sample2Kafka.json`) –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ process group –Ω–∞ –∫–∞–Ω–≤–∞—Å–µ.

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω—É–∂–Ω–æ:
- –ø–µ—Ä–µ–π—Ç–∏ –≤–Ω—É—Ç—Ä—å process group;
- –≤–∫–ª—é—á–∏—Ç—å Controller Services (Configure ‚Üí `Controller Services` ‚Üí Enable, –∏–ª–∏ ‚Äúenable all controller services‚Äù);
- –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
1) topic `Sample2Kafka` –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è: –æ–Ω —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø–∏—Å–∏ (–µ—Å–ª–∏ –≤ Kafka –≤–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤; –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω–æ –≤–∫–ª—é—á–µ–Ω–æ). –ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ topic –Ω–µ –ø–æ—è–≤–∏–ª—Å—è ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –≤ Kafka UI.
2) –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ flow –≤ NiFi (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç UI: import/upload template –¥–ª—è `.xml` –∏–ª–∏ import flow definition –¥–ª—è `.json`). –ï—Å–ª–∏ –≤—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ —Ä–∞–Ω—å—à–µ, —Ç–æ –ø–æ—Å–ª–µ `docker compose down` flow —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è.
3) –í–Ω—É—Ç—Ä–∏ flow –≤–∫–ª—é—á–∏—Ç–µ Controller Services, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã.

Kafka UI —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `docker-compose.yml`:
- Cluster name: `Kafka Cluster`
- Bootstrap Servers: `kafka:29092`

## Shared folder (–æ–±—â–∞—è –ø–∞–ø–∫–∞)
–ö–∞—Ç–∞–ª–æ–≥ `shared-folder/` –Ω–∞ —Ö–æ—Å—Ç–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä NiFi –∫–∞–∫ `/opt/nifi/nifi-current/ls-target` (—É–¥–æ–±–Ω–æ –¥–ª—è ListFile/GetFile).
–ï—Å–ª–∏ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏: `sudo chown -R $USER shared-folder`.

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```sh
docker compose logs -f nifi
docker compose logs -f kafka
docker compose exec postgres bash
```

–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ NiFi –∫ —Å–µ—Ä–≤–∏—Å–∞–º –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `host.docker.internal` –≤–º–µ—Å—Ç–æ `localhost`.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å—Ç–µ–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

### Checklist

- [ ] **NiFi UI –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è** –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:18443/nifi/ (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- [ ] **Kafka UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä** –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:8082/
- [ ] **–í Kafka UI –≤–∏–¥–µ–Ω topic `Sample2Kafka`** (–µ—Å–ª–∏ flow —É–∂–µ –∑–∞–ø—É—â–µ–Ω)
- [ ] **Postgres –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ DBeaver –∏–ª–∏ –∫–æ–Ω—Å–æ–ª—å:
  ```sh
  docker compose exec -it postgres bash -c "export PGPASSWORD=postgres; psql -U postgres -d app -c 'SELECT version();'"
  ```
- [ ] **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã** (–≤—Å–µ –≤ —Å—Ç–∞—Ç—É—Å–µ `Up`):
  ```sh
  docker compose ps
  ```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ flow

–ï—Å–ª–∏ –≤—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –∏ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏–º–µ—Ä—ã flow:
- [ ] –í NiFi –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã (–∑–µ–ª—ë–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)
- [ ] –í Kafka UI –≤ topic `Sample2Kafka` –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –í Postgres —Ç–∞–±–ª–∏—Ü–∞ `ods.samplekafka2postgres` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏:
  ```sh
  docker compose exec -it postgres bash -c "export PGPASSWORD=postgres; psql -U postgres -d app -c 'SELECT COUNT(*) FROM ods.samplekafka2postgres;'"
  ```

## –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

**–°–∏–º–ø—Ç–æ–º:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∏–ª–∏ —Å—Ä–∞–∑—É –ø–∞–¥–∞—é—Ç.
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
  ```sh
  docker compose logs -f nifi
  docker compose logs -f kafka
  docker compose logs -f postgres
  ```
- NiFi –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è 1‚Äì3 –º–∏–Ω—É—Ç—ã ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.

**–°–∏–º–ø—Ç–æ–º:** –û—à–∏–±–∫–∞ "port is already allocated".
- **–†–µ—à–µ–Ω–∏–µ:** –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã. –ò–∑–º–µ–Ω–∏—Ç–µ –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ –≤ `docker-compose.yml` –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —ç—Ç–∏ –ø–æ—Ä—Ç—ã.

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –≤ NiFi

**–°–∏–º–ø—Ç–æ–º:** –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤ NiFi –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Kafka –∏–ª–∏ Postgres.
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∞–¥—Ä–µ—Å–∞ "–∏–∑ NiFi" (—Å–º. —Ä–∞–∑–¥–µ–ª [–í–∞–∂–Ω–æ –ø—Ä–æ –∞–¥—Ä–µ—Å–∞](#–≤–∞–∂–Ω–æ-–ø—Ä–æ-–∞–¥—Ä–µ—Å–∞-–≤–Ω—É—Ç—Ä–∏-docker-–∏-—Å-—Ö–æ—Å—Ç–∞)):
  - Postgres: `postgres:5432` (–Ω–µ `localhost:5437`)
  - Kafka: `kafka:29092` (–Ω–µ `localhost:9092`)

**–°–∏–º–ø—Ç–æ–º:** Controller Services –≤—ã–∫–ª—é—á–µ–Ω—ã.
- **–†–µ—à–µ–Ω–∏–µ:** –í–Ω—É—Ç—Ä–∏ process group –æ—Ç–∫—Ä–æ–π—Ç–µ `Controller Services` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã ‚Üí `Enable`.

### –ü—Ä–æ–±–ª–µ–º—ã —Å Kafka

**–°–∏–º–ø—Ç–æ–º:** –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ Kafka UI.
- **–†–µ—à–µ–Ω–∏–µ:**
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä `PublishKafkaRecord_2_6` –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞—Å—Ç—ë—Ç —Å—á—ë—Ç—á–∏–∫ "out"
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ topic `Sample2Kafka` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏)
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Kafka: `docker compose logs -f kafka`

**–°–∏–º–ø—Ç–æ–º:** Consumer –≤ NiFi –Ω–µ —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.
- **–†–µ—à–µ–Ω–∏–µ:**
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `bootstrap.servers`: `kafka:29092`
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ consumer group –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –¥—Ä—É–≥–æ–º offset (–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π consumer group)

### –ü—Ä–æ–±–ª–µ–º—ã —Å Postgres

**–°–∏–º–ø—Ç–æ–º:** –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö –≤ Postgres.
- **–†–µ—à–µ–Ω–∏–µ:**
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç: –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç `SampleKafka2Postgres.sql`
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ JDBC-–¥—Ä–∞–π–≤–µ—Ä –ø–æ–¥–∫–ª—é—á—ë–Ω: `/opt/nifi/nifi-current/drivers/postgresql-42.7.4.jar`
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: `jdbc:postgresql://postgres:5432/app`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `postgres`, –ø–∞—Ä–æ–ª—å `postgres`

**–°–∏–º–ø—Ç–æ–º:** –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è, —Ö–æ—Ç—è flow —Ä–∞–±–æ—Ç–∞–µ—Ç.
- **–†–µ—à–µ–Ω–∏–µ:**
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —Ñ–∏–ª—å—Ç—Ä `QueryRecord` (relationship `GOOD_DATE`)
  - –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ `PutDatabaseRecord` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ `ods.load_samplekafka2postgres()` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

**–°–∏–º–ø—Ç–æ–º:** –û—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ `shared-folder/`.
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞:
  ```sh
  sudo chown -R $USER shared-folder
  ```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:
1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤: `docker compose logs`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker compose restart nifi` (–∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å: `docker compose down -v && docker compose up -d`
   > ‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Postgres, NiFi –∏ Registry.
