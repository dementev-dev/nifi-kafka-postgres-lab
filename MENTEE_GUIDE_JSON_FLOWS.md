# –ì–∞–π–¥ –¥–ª—è –º–µ–Ω—Ç–∏: –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏–º–µ—Ä—ã flow –Ω–∞ JSON (NiFi ‚Üí Kafka ‚Üí Postgres)

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-08 | **–í–µ—Ä—Å–∏—è NiFi:** 1.x.x | ‚Üê [–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ README](README.md)

–≠—Ç–æ—Ç –≥–∞–π–¥ –ø—Ä–æ –¥–≤–∞ flow definition —Ñ–∞–π–ª–∞:
- `nifi-templates/Sample2Kafka.json` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –∏—Ö –≤ Kafka topic `Sample2Kafka` –≤ –≤–∏–¥–µ JSON.
- `nifi-templates/SampleKafka2Postgres.json` ‚Äî —á–∏—Ç–∞–µ—Ç JSON –∏–∑ Kafka topic `Sample2Kafka` –∏ –ø–∏—à–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ Postgres.

## 0) –ß—Ç–æ –º—ã —Å—Ç—Ä–æ–∏–º (–æ–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞)
–¶–µ–ø–æ—á–∫–∞ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è:
1) NiFi –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å—å (–∫–∞–∫ ‚Äú—Å—Ç—Ä–æ—á–∫—É –¥–∞–Ω–Ω—ã—Ö‚Äù).
2) NiFi –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç—É –∑–∞–ø–∏—Å—å –≤ Kafka (–∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ topic).
3) –î—Ä—É–≥–æ–π flow –≤ NiFi —á–∏—Ç–∞–µ—Ç —ç—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka.
4) NiFi —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç/–≥–æ—Ç–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Ö –≤ Postgres.

–≠—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ —Ä–æ–ª–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:
- **NiFi** ‚Äî –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä (pipeline) –¥–∞–Ω–Ω—ã—Ö.
- **Kafka** ‚Äî "–ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫"/—à–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏.
- **Postgres** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω—ã SQL-–∑–∞–ø—Ä–æ—Å–∞–º–∏.

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```mermaid
graph TD
    subgraph Flow1["Flow 1: NiFi ‚Üí Kafka"]
        GR["GenerateRecord<br/>(–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)"]
        PK["PublishKafkaRecord_2_6<br/>(–ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Kafka)"]
        KT["Kafka Topic: Sample2Kafka"]
        
        GR --> PK --> KT
    end
    
    subgraph Flow2["Flow 2: Kafka ‚Üí Postgres"]
        CK["ConsumeKafkaRecord_2_6<br/>(—á—Ç–µ–Ω–∏–µ –∏–∑ Kafka)"]
        QR["QueryRecord<br/>(—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ GOOD_DATE)"]
        MC["MergeContent<br/>(micro-batch)"]
        PDR["PutDatabaseRecord<br/>(–≤—Å—Ç–∞–≤–∫–∞ –≤ stg)"]
        ES["ExecuteSQL<br/>(–≤—ã–∑–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã + –æ—á–∏—Å—Ç–∫–∞)"]
        
        KT --> CK --> QR --> MC --> PDR --> ES
    end
    
    style Flow1 fill:#e1f5ff,stroke:#01579b
    style Flow2 fill:#fff3e0,stroke:#e65100
    style KT fill:#fff9c4,stroke:#fbc02d
```

## 1) –ú–∏–Ω–∏-—Å–ª–æ–≤–∞—Ä—å NiFi (3 –ø–æ–Ω—è—Ç–∏—è)
- **FlowFile** ‚Äî ‚Äú—Å–æ–æ–±—â–µ–Ω–∏–µ‚Äù, –∫–æ—Ç–æ—Ä–æ–µ —Ç–µ—á—ë—Ç –ø–æ –≥—Ä–∞—Ñ—É. –£ FlowFile –µ—Å—Ç—å *content* (—Ç–µ–ª–æ) –∏ *attributes* (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ).
- **Processor** ‚Äî —à–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–ø—Ä–æ—á–∏—Ç–∞—Ç—å/–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å/–∑–∞–ø–∏—Å–∞—Ç—å).
- **Controller Service** ‚Äî –æ–±—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –∫–æ—Ç–æ—Ä—É—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, ‚Äú–∫–∞–∫ —á–∏—Ç–∞—Ç—å JSON‚Äù –∏–ª–∏ ‚Äú–∫–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –±–∞–∑–µ‚Äù).

## 2) –ö–∞–∫–æ–π JSON —É –Ω–∞—Å –≤ –ø—Ä–∏–º–µ—Ä–µ
–ó–∞–ø–∏—Å—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –ø–æ–ª–µ–π:
- `dttm` ‚Äî –¥–∞—Ç–∞/–≤—Ä–µ–º—è (timestamp).
- `txt` ‚Äî —Å—Ç—Ä–æ–∫–∞ (text).

–ü—Ä–∏–º–µ—Ä JSON-–∑–∞–ø–∏—Å–∏:
```json
{
  "dttm": "2026-01-08T11:49:52Z",
  "txt": "–ü—Ä–∏–º–µ—Ä —Ç–µ–∫—Å—Ç–∞"
}
```

–í –ø–µ—Ä–≤–æ–º flow –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º `GenerateRecord` –ø–æ —Å—Ö–µ–º–µ (–æ–Ω–∞ –∑–∞–¥–∞–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞).

–í–∞–∂–Ω–æ: –≤ —ç—Ç–æ–º —É—á–µ–±–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ **–º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º Avro** –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º Schema Registry. –°–æ–æ–±—â–µ–Ω–∏—è –≤ Kafka ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–π JSON.

## 3) –ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º: —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
1) –°—Ç–µ–Ω–¥ –ø–æ–¥–Ω—è—Ç: `docker compose up -d`
2) –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è NiFi: http://localhost:18443/nifi/
   > üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è. –õ–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è.
3) –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Kafka UI: http://localhost:8082/
4) **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–º–æ-—Ç–∞–±–ª–∏—Ü** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å—Ç–µ–Ω–¥–∞ –∏–ª–∏ –ø–æ—Å–ª–µ `docker compose down -v`):
   - `docker compose exec -T postgres psql -U postgres -d app -f /nifi-templates/SampleKafka2Postgres.sql`
   
   > ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –°–∫—Ä–∏–ø—Ç –Ω–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π ‚Äî –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –±—É–¥—É—Ç –æ—à–∏–±–∫–∏ –ø—Ä–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ö–µ–º—ã/—Ç–∞–±–ª–∏—Ü—ã.

## 4) Flow 1 ‚Äî `Sample2Kafka.json` (NiFi ‚Üí Kafka)
–¶–µ–ª—å: —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ JSON-—Å–æ–æ–±—â–µ–Ω–∏—è –≤ Kafka topic `Sample2Kafka`.

### –®–∞–≥–∏ –≤–Ω—É—Ç—Ä–∏ flow
1) `GenerateRecord`
   - –°–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –ø–æ —Å—Ö–µ–º–µ (–≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ `schema-text`).
   - –ß–∞—Å—Ç–æ—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–¥–∞—ë—Ç—Å—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ 2 —Å–µ–∫—É–Ω–¥—ã).
2) `PublishKafkaRecord_2_6`
   - –ë–µ—Ä—ë—Ç –∑–∞–ø–∏—Å–∏ –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –≤ Kafka.
   - –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
     - `bootstrap.servers`: `kafka:29092` (–∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –≤–Ω—É—Ç—Ä–∏ Docker).
     - `topic`: `Sample2Kafka`
     - `record-reader`: `JsonTreeReader` (–∫–∞–∫ ‚Äú–ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–∞–ø–∏—Å—å‚Äù –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π)
     - `record-writer`: `JsonRecordSetWriter` (–∫–∞–∫ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ JSON)

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ flow —Ä–∞–±–æ—Ç–∞–µ—Ç
- –í NiFi —É `PublishKafkaRecord_2_6` —Ä–∞—Å—Ç—ë—Ç —Å—á—ë—Ç—á–∏–∫ ‚Äúout‚Äù.
- –í Kafka UI –≤ topic `Sample2Kafka` –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è.

–ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ –Ω–µ—Ç –æ—á–µ—Ä–µ–¥–∏/–æ—à–∏–±–æ–∫ –Ω–∞ `failure`.
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏ NiFi —É–∫–∞–∑–∞–Ω–æ `kafka:29092`, –∞ –Ω–µ `localhost:9092`.

## 5) Flow 2 ‚Äî `SampleKafka2Postgres.json` (Kafka ‚Üí Postgres)
–¶–µ–ª—å: —á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ `Sample2Kafka`, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –∏ –∑–∞–ø–∏—Å–∞—Ç—å –∏—Ö –≤ Postgres.

### –®–∞–≥–∏ –≤–Ω—É—Ç—Ä–∏ flow
1) `ConsumeKafkaRecord_2_6`
   - –ß–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka topic `Sample2Kafka`.
   - –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
     - `bootstrap.servers`: `kafka:29092`
     - `topic`: `Sample2Kafka`
     - `record-reader`: `JsonTreeReader` (–∫–∞–∫ —Ä–∞–∑–æ–±—Ä–∞—Ç—å JSON –∏–∑ Kafka)
2) `QueryRecord`
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π ‚Äú—Ñ–∏–ª—å—Ç—Ä‚Äù –ø–æ –¥–∞–Ω–Ω—ã–º.
   - –í –ø—Ä–∏–º–µ—Ä–µ –µ—Å—Ç—å –∑–∞–ø—Ä–æ—Å `GOOD_DATE` (—ç—Ç–æ –∏–º—è relationship), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–±–∏—Ä–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ —É—Å–ª–æ–≤–∏—é –Ω–∞ `dttm`.
   - –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä.
3) `MergeContent` (micro-batch)
   - –°–æ–±–∏—Ä–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ FlowFile –≤ "–ø–∞—á–∫—É" –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ –ë–î.
   - –ó–∞—á–µ–º: –º–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö –≤—Å—Ç–∞–≤–æ–∫ (–∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí –æ—Ç–¥–µ–ª—å–Ω—ã–π insert) –º–æ–∂–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –ë–î; batching —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.
   - –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
     - `Minimum Number of Entries`: `100` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞—á–∫–∏
     - `Maximum Number of Entries`: `1000` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞—á–∫–∏
     - `Max Bin Age`: `30 seconds` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ, —á—Ç–æ–±—ã –ø–∞—á–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–ª–∞—Å—å –¥–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ
   - –ö–æ–º–ø—Ä–æ–º–∏—Å—Å: —á–µ–º –±–æ–ª—å—à–µ batch, —Ç–µ–º –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î, –Ω–æ –±–æ–ª—å—à–µ –∑–∞–¥–µ—Ä–∂–∫–∞ (latency).
4) `PutDatabaseRecord`
   - –í—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É `stg.samplekafka2postgres`.
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Postgres —á–µ—Ä–µ–∑ `DBCPConnectionPool`.
5) `ExecuteSQL`
   - –í—ã–∑—ã–≤–∞–µ—Ç —Ö—Ä–∞–Ω–∏–º—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É `ods.load_samplekafka2postgres()` –∏ —á–∏—Å—Ç–∏—Ç staging.
   - –≠—Ç–æ —à–∞–≥ ‚Äú–ø–µ—Ä–µ–ª–æ–∂–∏—Ç—å –≤ –≤–∏—Ç—Ä–∏–Ω—É/ODS‚Äù, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω.

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Postgres
–í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Postgres –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
- `docker compose exec -it postgres bash -c \"export PGPASSWORD=postgres; psql -U postgres -d app\"`

–ò –∑–∞—Ç–µ–º SQL:
- `select * from ods.samplekafka2postgres order by id desc limit 10;`

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Kafka –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ Kafka UI).
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –Ω–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ –Ω–∞ `parse.failure` (—É Kafka consumer) –∏–ª–∏ `failure` (—É DB).

## 6) –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–∏ –∫—É–¥–∞ —Å–º–æ—Ç—Ä–µ—Ç—å)
- **–í NiFi —É–∫–∞–∑–∞–ª–∏ `localhost` –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞**: –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `localhost` ‚Äî —ç—Ç–æ —Å–∞–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –Ω–µ Kafka/Postgres.
- **Controller Services –≤—ã–∫–ª—é—á–µ–Ω—ã**: –≤–Ω—É—Ç—Ä–∏ process group –æ—Ç–∫—Ä–æ–π—Ç–µ `Controller Services` –∏ –≤–∫–ª—é—á–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã.
- **–ù–µ—Ç —Ç–∞–±–ª–∏—Ü/–ø—Ä–æ—Ü–µ–¥—É—Ä—ã**: –ø–æ—Å–ª–µ ‚Äú—á–∏—Å—Ç–æ–≥–æ —Å–±—Ä–æ—Å–∞‚Äù –Ω—É–∂–Ω–æ —Å–Ω–æ–≤–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `SampleKafka2Postgres.sql`.

## 7) –ú–∏–Ω–∏-—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è (5‚Äì10 –º–∏–Ω—É—Ç)

1) **–ò–∑–º–µ–Ω–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**
   - –í `Sample2Kafka.json` –ø–æ–º–µ–Ω—è–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ `GenerateRecord` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2 sec ‚Üí 5 sec) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Kafka UI.

2) **–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä**
   - –í `QueryRecord` –∏–∑–º–µ–Ω–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä `GOOD_DATE` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–æ–ª–µ–µ –∂—ë—Å—Ç–∫–æ–µ/–º—è–≥–∫–æ–µ —É—Å–ª–æ–≤–∏–µ) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ Postgres.

3) **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ)**
   - –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ –ø–æ–ª–µ –≤ —Å—Ö–µ–º—É `GenerateRecord` –∏ –ø—Ä–æ—Ç–∞—â–∏—Ç–µ –µ–≥–æ –¥–æ Postgres.
   - –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å SQL-—Å—Ö–µ–º—É/—Ç–∞–±–ª–∏—Ü—ã.
   - *–ü–æ–¥—Å–∫–∞–∑–∫–∞:* –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ö–µ–º–µ JSON, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –∏ SQL-—Å–∫—Ä–∏–ø—Ç–µ.
